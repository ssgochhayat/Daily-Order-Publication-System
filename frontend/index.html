<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Login Page</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet" />
</head>
<body>
    <div class="container" id="container">
        <aside class="aside-menu" id="aside-menu">
            <ul>
                <li><a href="/admin-authentication.html" id="admin-panel">Admin-section</a></li>
                <li><a href="/Feedback.html" id="feedback">Feedback</a></li>
                <li><a href="#" id="aside-logout" style="display: none;">Logout</a></li>
            </ul>
        </aside>
        <nav class="navbar" id="navbar">
            <div class="logo">
                <img src="DO2.jpg" alt="Logo" />
            </div>
            <ul class="nav-links">
                <li><a href="/">HOME</a></li>
                <li class="dropdown">
                    <a href="#">DEPARTMENTS</a>
                    <ul class="dropdown-menu">
                        <li><a id="clr" href="#">Department 1</a></li>
                        <li><a id="clr" href="#">Department 2</a></li>
                        <li><a id="clr" href="#">Department 3</a></li>
                        <li><a id="clr" href="#">Department 4</a></li>
                        <li><a id="clr" href="#">Department 5</a></li>
                        <li><a id="clr" href="#">Department 6</a></li>
                    </ul>
                </li>
                <li><a href="/About.html">ABOUT</a></li>
                <li><a href="/notices.html" id="dashboard">NOTICES</a></li>
            </ul>
            <button id="logout" style="display: none;">Logout</button>
            <div class="hamburger-menu" id="hamburger-menu">&#9776;</div>
        </nav>
        <div class="main">
            <div class="form-container" id="form-container">
                <div class="login-card">
                    <div class="login-section" id="login-section">
                        <div class="avatar">
                            <img src="https://imgs.search.brave.com/JxtHhMcMQ8LpkUszQmDnoy6Vom835ckzCiB5sIy9Fr8/rs:fit:500:0:0/g:ce/aHR0cHM6Ly9pY29u/cy52ZXJ5aWNvbi5j/b20vcG5nLzEyOC9t/aXNjZWxsYW5lb3Vz/L2thcmEvcGVyc29u/LTMzLnBuZw" alt="User Icon" class="avatar-img" />
                        </div>
                        <form class="login-form" id="login-form">
                            <div class="form-group">
                                <label for="username">Username or email</label>
                                <input type="text" id="username" placeholder="Username or email" required />
                            </div>
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" id="password" placeholder="Password" required />
                            </div>
                            <button type="submit">LOGIN</button>
                        </form>
                        <div class="signup-link">
                            <a href="#" id="show-signup">Don't have an account? Signup</a>
                        </div>
                    </div>
                    <div class="signup-section" id="signup-section" style="display: none">
                        <div class="avatar">
                            <img src="https://imgs.search.brave.com/JxtHhMcMQ8LpkUszQmDnoy6Vom835ckzCiB5sIy9Fr8/rs:fit:500:0:0/g:ce/aHR0cHM6Ly9pY29u/cy52ZXJ5aWNvbi5j/b20vcG5nLzEyOC9t/aXNjZWxsYW5lb3Vz/L2thcmEvcGVyc29u/LTMzLnBuZw" alt="User Icon" class="avatar-img" />
                        </div>
                        <form class="signup-form" id="signup-form">
                            <div class="form-group">
                                <label for="new-username">Username</label>
                                <input type="text" id="new-username" placeholder="Username" required />
                            </div>
                            <div class="form-group">
                                <label for="new-aadharnumber">AadharCard</label>
                                <input type="text" id="new-aadharnumber" placeholder="Aadhar no." maxlength="12" required />
                            </div>
                            <div class="form-group">
                                <label for="new-email">Email</label>
                                <input type="email" id="new-email" placeholder="Email" required />
                            </div>
                            <div class="form-group">
                                <label for="new-phonenumber">Ph.No</label>
                                <input type="text" id="new-phonenumber" placeholder="Phone no." maxlength="10" required />
                            </div>
                            <div class="form-group">
                                <label for="new-password">Password</label>
                                <input type="password" id="new-password" placeholder="Password" required />
                            </div>
                            <button type="submit">SIGNUP</button>
                        </form>
                        <div class="login-link">
                            <a href="#" id="show-login">Already have an account? Login</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="welcome-section" id="welcome-section">
                <h2>Welcome Daily Order Publication</h2>
                <p>Hey, welcome aboard! We're thrilled to have you in our online community</p>
            </div>
            <div class="admin-section" id="admin-section" style="display: none">
                <div class="box" id="box">
                    <div class="notice-head">
                        <h2>Notice Board</h2>
                        <button id="add-notice">+</button>
                        <input type="file" id="file-input" style="display: none" />
                    </div>
                    <ul class="notices" id="notices"></ul>
                </div>
            </div>
        </div>
        <footer>
            <div class="footer-content">
                <p>&copy; 2024 daily order publication system. All rights reserved</p>
            </div>
        </footer>
    </div>
    <div id="file-preview-modal" class="modal" style="display: none">
        <div class="modal-content">
            <span class="close">&times;</span>
            <embed id="file-preview" src type="application/pdf" width="100%" height="600px" />
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const showSignup = document.getElementById('show-signup');
            const showLogin = document.getElementById('show-login');
            const loginSection = document.getElementById('login-section');
            const signupSection = document.getElementById('signup-section');
            const logoutButton = document.getElementById('logout');
            const asideLogoutButton = document.getElementById('aside-logout');
            const modal = document.getElementById('file-preview-modal');
            const closeModal = document.querySelector('.close');

            function checkLoginStatus() {
                const user = localStorage.getItem('user');
                if (user) {
                    logoutButton.style.display = 'block';
                    asideLogoutButton.style.display = 'block';
                } else {
                    logoutButton.style.display = 'none';
                    asideLogoutButton.style.display = 'none';
                }
            }

            showSignup.addEventListener('click', () => {
                loginSection.style.display = 'none';
                signupSection.style.display = 'block';
            });

            showLogin.addEventListener('click', () => {
                loginSection.style.display = 'block';
                signupSection.style.display = 'none';
            });

            closeModal.addEventListener('click', () => {
                modal.style.display = 'none';
            });

            logoutButton.addEventListener('click', () => {
                localStorage.removeItem('user');
                checkLoginStatus();
                alert('Logged out successfully!');
            });

            asideLogoutButton.addEventListener('click', () => {
                localStorage.removeItem('user');
                checkLoginStatus();
                alert('Logged out successfully!');
            });

            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                try {
                    const response = await fetch('http://localhost:3000/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, password })
                    });
                    const data = await response.json();
                    if (response.ok) {
                        localStorage.setItem('user', JSON.stringify(data.data));
                        alert('Login successful!');
                        checkLoginStatus();
                    } else {
                        alert('Login failed: ' + data.message);
                    }
                } catch (error) {
                    alert('An error occurred: ' + error.message);
                }
            });

            signupForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const username = document.getElementById('new-username').value;
                const password = document.getElementById('new-password').value;
                const AadharCard = document.getElementById('new-aadharnumber').value;
                const email = document.getElementById('new-email').value;
                const phone = document.getElementById('new-phonenumber').value;
                try {
                    const response = await fetch('http://localhost:3000/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, password, AadharCard, email, phone })
                    });
                    const data = await response.json();
                    if (response.ok) {
                        localStorage.setItem('user', JSON.stringify(data.data));
                        alert('Signup successful!');
                        checkLoginStatus();
                    } else {
                        alert('Signup failed: ' + data.message);
                    }
                } catch (error) {
                    alert('An error occurred: ' + error.message);
                }
            });

            checkLoginStatus();
        });
    </script>
    <script src="./script.js"></script>
</body>
</html>
